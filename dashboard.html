<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="192x192" href="favicon/web-app-manifest-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="favicon/web-app-manifest-512x512.png">
    <link rel="manifest" href="favicon/site.webmanifest">
    <meta name="theme-color" content="#ffffff">
  <title>Dashboard - Paws & Claws</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <header class="header">
    <div class="logo">
      <img src="images\pets\logo.jpg" alt="Paws & Claws Logo">
      <h1>Paws & Claws</h1>
    </div>
    <nav class="main-nav">
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About Us</a></li>
        <li><a href="contact.html">Contact Us</a></li>
        <li><a href="#" id="logout-button">Logout</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <div class="content-area">
      <h2 id="welcome-message"></h2>

      <div class="dashboard-sections">
        <div class="dashboard-section">
          <h3>My Wishlist</h3>
          <div class="wishlist-container" id="wishlist-container"></div>
        </div>

        <div class="dashboard-section">
          <h3>My Requested Pets</h3>
          <div class="requests-container" id="requests-container"></div>
        </div>

        <div class="dashboard-section">
          <h3>My Adopted Pets</h3>
          <div class="adopted-container" id="adopted-container"></div>
        </div>
      </div>
    </div>

    <div id="pet-modal" class="modal-overlay" style="display: none;">
      <div class="modal-content">
        <span class="modal-close-btn">&times;</span>
        <img id="modal-pet-image" src="" alt="Pet Image">
        <h3 id="modal-pet-name"></h3>
        <p><strong>Breed:</strong> <span id="modal-pet-breed"></span></p>
        <p><strong>Age:</strong> <span id="modal-pet-age"></span></p>
        <p><strong>Size:</strong> <span id="modal-pet-size"></span></p>
        <p id="modal-pet-description"></p>
      </div>
    </div>
  </main>

  <script>
    // Redirect if not logged in
    if (!localStorage.getItem('currentUser')) {
      window.location.href = 'login.html';
    }

    const currentUser = localStorage.getItem('currentUser');

    document.getElementById('welcome-message').textContent = `Welcome, ${currentUser}!`;

    // Logout functionality
    document.getElementById('logout-button').addEventListener('click', (e) => {
      e.preventDefault();
      localStorage.removeItem('currentUser');
      window.location.href = 'index.html';
    });

    // --- Consistent Pet Data ---
    // PASTE THIS ENTIRE BLOCK to replace the old pets array
    // --- Enhanced Pet Data ---
    const pets = [
      { id: "pet1", type: "dog", name: "Buddy", breed: "Golden Retriever", age: "2 years", size: "Large", image: "images/images/Leo.jpg", description: "Buddy is a friendly and energetic Golden Retriever who loves to play fetch and go for long walks. He is great with kids and other dogs." },
      { id: "pet2", type: "cat", name: "Whiskers", breed: "Siamese Cat", age: "1 year", size: "Small", image: "images/images/Rex.jpg", description: "Whiskers is a curious and affectionate Siamese cat. She enjoys napping in sunny spots and chasing laser pointers." },
      { id: "pet3", type: "rabbit", name: "Snowball", breed: "Mini Lop", age: "6 months", size: "Small", image: "images/pets/thumper.jpg", description: "Snowball is a gentle and calm Mini Lop. He is litter-trained and loves being gently petted." },
      { id: "pet4", type: "fish", name: "Finley", breed: "Betta Fish", age: "3 months", size: "Small", image: "images/pets/goldie.jpg", description: "Finley is a vibrant Betta with a flowing tail. He is an active swimmer and adds a splash of color to any room." },
      { id: "pet5", type: "dog", name: "Rocky", breed: "Bulldog", age: "3 years", size: "Medium", image: "images/pets/buddy.jpg", description: "Rocky is a loyal and laid-back Bulldog. His favorite activities are napping and getting belly rubs." },
      { id: "pet6", type: "cat", name: "Milo", breed: "Persian Cat", age: "2 years", size: "Small", image: "images/cat 2.jpg", description: "Milo is a majestic Persian with a luxurious coat. He is a calm soul who enjoys a quiet and peaceful environment." },
      { id: "pet7", type: "bird", name: "Coco", breed: "Parrot", age: "1 year", size: "Small", image: "https://images.unsplash.com/photo-1543852786-1cf6624b9987", description: "Coco is a cheerful Parrot who is learning to mimic sounds. She loves fruits and interacting with people." },
      { id: "pet8", type: "dog", name: "Max", breed: "Beagle", age: "4 years", size: "Medium", image: "https://images.unsplash.com/photo-1558788353-f76d92427f16", description: "Max is an adventurous Beagle who loves to explore. He has a great sense of smell and is always ready for a new adventure." },
      { id: "pet9", type: "cat", name: "Luna", breed: "Maine Coon", age: "2 years", size: "Large", image: "images/images/luna.jpg", description: "Luna is a gentle giant. This Maine Coon is very sociable, loves to cuddle, and gets along well with other pets." },
    ];

    // --- Modal Elements ---
    const modal = document.getElementById('pet-modal');
    const closeModalBtn = document.querySelector('.modal-close-btn');

    const userActivity = JSON.parse(localStorage.getItem('userActivity')) || {};
    const currentUserData = userActivity[currentUser] || { wishlist: [], requests: [], adopted: [] };

    const wishlistContainer = document.getElementById('wishlist-container');
    const requestsContainer = document.getElementById('requests-container');
    const adoptedContainer = document.getElementById('adopted-container');

    // --- Modal Functions ---
    function openModal(petId) {
      const pet = pets.find(p => p.id === petId);
      if (!pet) return;

      document.getElementById('modal-pet-image').src = pet.image;
      document.getElementById('modal-pet-name').textContent = pet.name;
      document.getElementById('modal-pet-breed').textContent = pet.breed;
      document.getElementById('modal-pet-age').textContent = pet.age;
      document.getElementById('modal-pet-size').textContent = pet.size;
      document.getElementById('modal-pet-description').textContent = pet.description;

      modal.style.display = 'flex';
    }

    function closeModal() {
      modal.style.display = 'none';
    }

    // --- Event Listeners for Modal ---
    closeModalBtn.addEventListener('click', closeModal);
    window.addEventListener('click', (event) => {
      if (event.target == modal) {
        closeModal();
      }
    });

    // --- Event Delegation for Dashboard clicks ---
    function handleDashboardClick(event) {
      const target = event.target;

      // Handle REMOVE button click
      if (target.classList.contains('remove-wishlist-btn')) {
        const petIdToRemove = target.getAttribute('data-pet-id');
        currentUserData.wishlist = currentUserData.wishlist.filter(id => id !== petIdToRemove);
        userActivity[currentUser] = currentUserData;
        localStorage.setItem('userActivity', JSON.stringify(userActivity));
        renderDashboard(); // Re-render to show the change
        return; // Stop further execution to prevent modal opening
      }

      // Handle opening the MODAL when a pet item is clicked (but not the remove button)
      const petItem = target.closest('[data-pet-id]');
      if (petItem) {
        const petId = petItem.getAttribute('data-pet-id');
        openModal(petId);
      }
    }

    wishlistContainer.addEventListener('click', handleDashboardClick);
    requestsContainer.addEventListener('click', handleDashboardClick); // Requests can also open the modal

    // This function renders the dashboard content from the user's data
    function renderDashboard() {
      // --- Render Wishlist ---
      wishlistContainer.innerHTML = '';
      if (currentUserData.wishlist.length === 0) {
        wishlistContainer.innerHTML = '<p class="empty-message">Your wishlist is empty.</p>';
      } else {
        currentUserData.wishlist.forEach(petId => {
          const pet = pets.find(p => p.id === petId);
          if (pet) {
            const item = document.createElement('div');
            item.classList.add('wishlist-item');
            item.setAttribute('data-pet-id', pet.id);
            item.innerHTML = `
                <img src="${pet.image}" alt="${pet.name}">
                <div class="item-details">
                    <h4>${pet.name}</h4>
                    <p>${pet.breed}</p>
                </div>
                <button class="remove-wishlist-btn" data-pet-id="${pet.id}">Remove</button>
            `;
            wishlistContainer.appendChild(item);
          }
        });
      }

      // --- Render Requests ---
      requestsContainer.innerHTML = '';
      if (currentUserData.requests.length === 0) {
        requestsContainer.innerHTML = '<p class="empty-message">You have not requested any pets.</p>';
      } else {
        currentUserData.requests.forEach(petId => {
          const pet = pets.find(p => p.id === petId);
          if (pet) {
            const item = document.createElement('div');
            item.classList.add('request-item');
            item.setAttribute('data-pet-id', pet.id);
            item.innerHTML = `
                <img src="${pet.image}" alt="${pet.name}">
                <div class="item-details">
                    <h4>${pet.name}</h4>
                    <p>Status: <span class="status-pending">Pending</span></p>
                </div>
            `;
            requestsContainer.appendChild(item);
          }
        });
      }

      // Render Adopted pets (or a placeholder)
      adoptedContainer.innerHTML = '<p class="info-message">Adopted pets feature coming soon.</p>';
    }

    // Initial call to render the dashboard content
    renderDashboard();
  </script>
</body>


</html>
